{"version":3,"sources":["app/db.cljs"],"mappings":";AAIA,GAAA,QAAAA,gCAAAC,mCAAAC;AAAA;AAAA,AAAA,AAASC,eAAM,gDAAA,hDAACC;;AAEhB,cAAA,dAAMC;AAAN,AACE,IAAMC,UAAQ,qBAAA,rBAAUC;IAClBC,eAAa,qBAAA,rBAAUD;AAD7B,AAEE,oBAAMD;AAAN,AAAc,AAACG,sBAAON,aAAM,8CAAA,AAAAO,8BAAA,5EAACC,8DAAOR,uEAAeG;;AAAnD;;AACA,oBAAM,iBAAAM,oBAAKJ;AAAL,AAAA,oBAAAI;AACK,OAACC,gDAAKL,aAAa,AAACM;;AADzBF;;;AAAN,AAEE,OAACH,sBAAON,aAAM,8CAAA,AAAAO,8BAAA,yDAAA,rIAACC,8DAAOR;;AAFxB;;;AAIJ,yBAAA,zBAAMY,0DACHC,IAAIC,KAAKC,IAAIC;AADhB,AAEE,qBAAA,rBAAUZ,+BAA0B,AAAA,uFAAUY;;AAC9C,4BAAA,rBAAUZ,mCAA8B,AAAA,mGAAeY;;AAEzD,iCAAA,jCAACC,oBAAUjB,wEAAeY","names":["js/app","js/app.db","js/app.db.store","app.db/store","reagent.core.atom","app.db/init","content","js/localStorage","last-updated","cljs.core/reset!","cljs.core/deref","cljs.core.assoc","and__5043__auto__","cljs.core.not_EQ_","app.date/get-date-today","app.db/on-store-change","key","atom","old","new","cljs.core/add-watch"],"sourcesContent":["(ns app.db\n  (:require [reagent.core :as r]\n            [app.date :as date]))\n\n(defonce store (r/atom {}))\n\n(defn init []\n  (let [content (.getItem js/localStorage \"content\")\n        last-updated (.getItem js/localStorage \"lastUpdated\")]\n    (when content (reset! store (assoc @store :content content)))\n    (when (and last-updated\n               (not= last-updated (date/get-date-today)))\n      (reset! store (assoc @store :content \"\")))))\n\n(defn on-store-change\n  [key atom old new]\n  (.setItem js/localStorage \"content\" (:content new))\n  (.setItem js/localStorage \"lastUpdated\" (:last-updated new)))\n\n(add-watch store :watcher on-store-change)\n"]}